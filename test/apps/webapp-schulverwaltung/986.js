"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[986],{1154:(fe,f,a)=>{a.r(f),a.d(f,{DashboardModule:()=>me});var C=a(6482),l=a(3519),e=a(4650),x=a(4707),i=a(4004),d=a(9300),h=a(3900),T=a(9841),g=a(8029),u=a(3978),S=a(8623),L=a(8714),A=a(386),Z=a(1303);const D=["LessonTeacherRole","ClassTeacherRole","TeacherRole","AbsenceAdministratorRole"],y=["LessonTeacherRole","TeacherRole","StudentRole","SubstituteAdministratorRole"],R=["LessonTeacherRole","StudentRole"];let b=(()=>{class n{constructor(t,o,p,m,be){this.settingsService=t,this.lessonPresencesService=o,this.studentsService=p,this.storageService=m,this.settings=be,this.rolesAndPermissions$=this.settingsService.getRolesAndPermissions(),this.studentId$=new x.t(1),this.loading$=this.rolesAndPermissions$.pipe((0,i.U)(c=>null==c)),this.hasSearch$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(D))),this.hasActions$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(y))),this.hasTimetable$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(R))),this.hasLessonTeacherRole$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(["LessonTeacherRole"]))),this.hasPresenceControl$=this.hasLessonTeacherRole$.pipe((0,d.h)(u.fQ),(0,h.w)(c=>this.lessonPresencesService.hasLessonsLessonTeacher())),this.checkableAbsencesCount$=this.hasLessonTeacherRole$.pipe((0,d.h)(u.fQ),(0,h.w)(c=>this.lessonPresencesService.checkableAbsencesCount())),this.unconfirmedCount$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(["LessonTeacherRole","ClassTeacherRole"])),(0,d.h)(u.fQ),(0,h.w)(()=>this.lessonPresencesService.getListOfUnconfirmed()),(0,i.U)(c=>c.length)),this.hasOpenAbsences$=this.unconfirmedCount$.pipe((0,i.U)(c=>c>0)),this.hasTeacherRole$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(["TeacherRole"]))),this.hasStudentRole$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(["StudentRole"]))),this.openAbsencesCount$=(0,T.a)([this.studentId$,this.hasStudentRole$.pipe((0,d.h)(u.fQ))]).pipe((0,h.w)(([c])=>this.studentsService.getLessonAbsences(c)),(0,i.U)(this.openAbsencesCount.bind(this))),this.hasSubstituteAdministratorRole$=this.rolesAndPermissions$.pipe((0,i.U)(this.hasRoles(["SubstituteAdministratorRole"])));const _=this.storageService.getPayload()?.id_person;_&&this.studentId$.next(Number(_))}hasRoles(t){return o=>(o??[]).some(p=>t.includes(p))}openAbsencesCount(t){return t.filter(o=>o.ConfirmationStateId===this.settings.unconfirmedAbsenceStateId).length}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(S.s),e.LFG(L.q),e.LFG(A.l),e.LFG(Z.V),e.LFG(g.L6))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var r=a(6895),$=a(1104),P=a(2925),z=a(6628);let I=(()=>{class n{constructor(t,o){this.studentsRestService=t,this.router=o}navigateToDossier(t){const o=Number(t);this.router.navigate(["dashboard","student",o,"addresses"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(A.l),e.Y36(l.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["erz-dashboard-search"]],decls:1,vars:2,consts:[[3,"typeaheadService","placeholder","valueChange"]],template:function(t,o){1&t&&(e.TgZ(0,"erz-typeahead",0),e.NdJ("valueChange",function(m){return m&&o.navigateToDossier(m)}),e.qZA()),2&t&&e.Q6J("typeaheadService",o.studentsRestService)("placeholder","dashboard.search.placeholder")},dependencies:[z.t],styles:["[_nghost-%COMP%]{display:block;padding:.75rem;background:rgb(247,233,210)}"]}),n})();var v=a(6188);function O(n,s){1&n&&e.GkF(0)}function Q(n,s){if(1&n&&(e.TgZ(0,"a",3),e.YNc(1,O,1,0,"ng-container",4),e.qZA()),2&n){const t=e.oxw(),o=e.MAs(3);e.Q6J("routerLink",t.link)("queryParams",t.linkParams),e.xp6(1),e.Q6J("ngTemplateOutlet",o)}}function J(n,s){1&n&&e.GkF(0)}function M(n,s){if(1&n&&(e.TgZ(0,"a",5),e.YNc(1,J,1,0,"ng-container",4),e.qZA()),2&n){const t=e.oxw(),o=e.MAs(3);e.Q6J("href",t.externalLink,e.LSH),e.xp6(1),e.Q6J("ngTemplateOutlet",o)}}function U(n,s){if(1&n&&(e.TgZ(0,"span",9),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.count)}}function k(n,s){1&n&&(e.O4$(),e.TgZ(0,"svg",10),e._UZ(1,"path",11),e.qZA())}function Y(n,s){if(1&n&&(e.TgZ(0,"span",6),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div"),e.YNc(4,U,2,1,"span",7),e.YNc(5,k,2,0,"ng-template",null,8,e.W1O),e.qZA()),2&n){const t=e.MAs(6),o=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,o.label)),e.xp6(3),e.Q6J("ngIf",o.count)("ngIfElse",t)}}let N=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["erz-dashboard-action"]],inputs:{label:"label",count:"count",link:"link",linkParams:"linkParams",externalLink:"externalLink"},decls:4,vars:2,consts:[[3,"routerLink","queryParams",4,"ngIf"],[3,"href",4,"ngIf"],["actionContent",""],[3,"routerLink","queryParams"],[4,"ngTemplateOutlet"],[3,"href"],[1,"label"],["class","count",4,"ngIf","ngIfElse"],["icon",""],[1,"count"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none"],["fill","currentColor","d","m12 20-1.425-1.4 5.6-5.6H4v-2h12.175l-5.6-5.6L12 4l8 8-8 8Z"]],template:function(t,o){1&t&&(e.YNc(0,Q,2,3,"a",0),e.YNc(1,M,2,2,"a",1),e.YNc(2,Y,7,5,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ngIf",!o.externalLink),e.xp6(1),e.Q6J("ngIf",o.externalLink))},dependencies:[r.O5,r.tP,l.yS,v.X$],styles:["a[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;background:rgb(247,233,210);text-decoration:none;line-height:1}a[_ngcontent-%COMP%]:hover{background:rgb(242,224,195)}.label[_ngcontent-%COMP%]{font-weight:400}.count[_ngcontent-%COMP%]{font-size:1.5rem}"]}),n})();const w=function(){return["/presence-control"]};function F(n,s){1&n&&e._UZ(0,"erz-dashboard-action",4),2&n&&e.Q6J("label","dashboard.actions.presence-control")("link",e.DdM(2,w))}const E=function(){return["/edit-absences"]};function j(n,s){if(1&n&&(e._UZ(0,"erz-dashboard-action",5),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("label","dashboard.actions.edit-absences")("link",e.DdM(6,E))("linkParams",t.editAbsencesParams)("count",e.lcZ(1,4,t.dashboardService.checkableAbsencesCount$))}}const G=function(){return["/open-absences"]};function B(n,s){if(1&n&&(e._UZ(0,"erz-dashboard-action",6),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("label","dashboard.actions.open-absences")("link",e.DdM(5,G))("count",e.lcZ(1,3,t.dashboardService.unconfirmedCount$))}}const X=function(){return["/events"]};function q(n,s){1&n&&e._UZ(0,"erz-dashboard-action",4),2&n&&e.Q6J("label","dashboard.actions.tests")("link",e.DdM(2,X))}const H=function(){return["/my-absences","report"]};function W(n,s){1&n&&e._UZ(0,"erz-dashboard-action",4),2&n&&e.Q6J("label","dashboard.actions.my-absences-report")("link",e.DdM(2,H))}const V=function(){return["/my-absences"]};function K(n,s){if(1&n&&(e._UZ(0,"erz-dashboard-action",6),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("label","dashboard.actions.my-absences")("link",e.DdM(5,V))("count",e.lcZ(1,3,t.dashboardService.openAbsencesCount$))}}function ee(n,s){if(1&n&&e._UZ(0,"erz-dashboard-action",7),2&n){const t=e.oxw();e.Q6J("label","dashboard.actions.substitutions")("externalLink",t.substitutionsAdminLink)}}let ne=(()=>{class n{constructor(t,o){this.dashboardService=t,this.settings=o}get editAbsencesParams(){return{confirmationStates:this.settings.checkableAbsenceStateId}}get substitutionsAdminLink(){return this.settings.dashboard.substitutionsAdminLink}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b),e.Y36(g.L6))},n.\u0275cmp=e.Xpm({type:n,selectors:[["erz-dashboard-actions"]],decls:14,vars:21,consts:[[3,"label","link",4,"ngIf"],[3,"label","link","linkParams","count",4,"ngIf"],[3,"label","link","count",4,"ngIf"],[3,"label","externalLink",4,"ngIf"],[3,"label","link"],[3,"label","link","linkParams","count"],[3,"label","link","count"],[3,"label","externalLink"]],template:function(t,o){1&t&&(e.YNc(0,F,1,3,"erz-dashboard-action",0),e.ALo(1,"async"),e.YNc(2,j,2,7,"erz-dashboard-action",1),e.ALo(3,"async"),e.YNc(4,B,2,6,"erz-dashboard-action",2),e.ALo(5,"async"),e.YNc(6,q,1,3,"erz-dashboard-action",0),e.ALo(7,"async"),e.YNc(8,W,1,3,"erz-dashboard-action",0),e.ALo(9,"async"),e.YNc(10,K,2,6,"erz-dashboard-action",2),e.ALo(11,"async"),e.YNc(12,ee,1,2,"erz-dashboard-action",3),e.ALo(13,"async")),2&t&&(e.Q6J("ngIf",e.lcZ(1,7,o.dashboardService.hasPresenceControl$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,9,o.dashboardService.hasLessonTeacherRole$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,11,o.dashboardService.hasOpenAbsences$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,13,o.dashboardService.hasTeacherRole$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,15,o.dashboardService.hasStudentRole$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(11,17,o.dashboardService.hasStudentRole$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(13,19,o.dashboardService.hasSubstituteAdministratorRole$)))},dependencies:[r.O5,N,r.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}"]}),n})();function te(n,s){1&n&&e._UZ(0,"erz-spinner")}function se(n,s){1&n&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"dashboard.no-access")," "))}function oe(n,s){1&n&&(e.TgZ(0,"div")(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"erz-dashboard-search"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"dashboard.search.title")))}function ae(n,s){1&n&&(e.TgZ(0,"div")(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"erz-dashboard-actions"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"dashboard.actions.title")))}function ie(n,s){if(1&n&&(e.TgZ(0,"div",5),e.YNc(1,oe,5,3,"div",1),e.YNc(2,ae,5,3,"div",1),e.qZA()),2&n){const t=e.oxw().erzLet;e.xp6(1),e.Q6J("ngIf",t.hasSearch),e.xp6(1),e.Q6J("ngIf",t.hasActions)}}function ce(n,s){1&n&&(e.TgZ(0,"div",6)(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"dashboard.timetable")))}function re(n,s){if(1&n&&(e.TgZ(0,"div")(1,"h1"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,te,1,0,"erz-spinner",1),e.YNc(5,se,3,3,"p",1),e.TgZ(6,"div",2),e.YNc(7,ie,3,2,"div",3),e.YNc(8,ce,4,3,"div",4),e.qZA()()),2&n){const t=s.erzLet;e.xp6(1),e.ekj("visually-hidden",t.loading||t.hasSearch||t.hasActions||t.hasTimetable),e.xp6(1),e.hij(" ",e.lcZ(3,7,"dashboard.heading")," "),e.xp6(2),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!(t.loading||t.hasSearch||t.hasActions||t.hasTimetable)),e.xp6(2),e.Q6J("ngIf",t.hasSearch||t.hasActions),e.xp6(1),e.Q6J("ngIf",t.hasTimetable)}}const le=function(n,s,t,o){return{loading:n,hasSearch:s,hasActions:t,hasTimetable:o}},ue=[{path:"",component:(()=>{class n{constructor(t){this.dashboardService=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["erz-dashboard"]],decls:5,vars:14,consts:[[4,"erzLet"],[4,"ngIf"],[1,"columns"],["class","search-actions-column",4,"ngIf"],["class","timetable-column",4,"ngIf"],[1,"search-actions-column"],[1,"timetable-column"]],template:function(t,o){1&t&&(e.YNc(0,re,9,9,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async")),2&t&&e.Q6J("erzLet",e.l5B(9,le,e.lcZ(1,1,o.dashboardService.loading$),e.lcZ(2,3,o.dashboardService.hasSearch$),e.lcZ(3,5,o.dashboardService.hasActions$),e.lcZ(4,7,o.dashboardService.hasTimetable$)))},dependencies:[r.O5,$.e,P.O,I,ne,r.Ov,v.X$],styles:[".columns[_ngcontent-%COMP%]{display:flex;flex-direction:column}.columns[_ngcontent-%COMP%], .search-actions-column[_ngcontent-%COMP%]{gap:3rem}.search-actions-column[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;max-width:40rem}.timetable-column[_ngcontent-%COMP%]{flex:2}@media (min-width: 992px){.columns[_ngcontent-%COMP%]{flex-direction:row;gap:1.5rem}.search-actions-column[_ngcontent-%COMP%]{max-width:33%}}"],changeDetection:0}),n})()},a(7467).H];let pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.Bz.forChild(ue),l.Bz]}),n})(),me=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[b],imports:[C.m,pe]}),n})()}}]);